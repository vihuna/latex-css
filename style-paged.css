/* LaTeX.css paged layout using Paged.js */

@layer latexcss, latexcss-paged-print, latexcss-paged-screen;
@import url("style.css") layer(latexcss);

@layer latexcss-paged-print {
  :root {
    --body-background-color: hsl(0, 0%, 91%);
    --page-shadow-color: hsl(0, 0%, 81%);
  }
  .latex-dark {
    --body-background-color: hsl(0, 0%, 23%);
    --page-shadow-color: black;
  }
}

/* Styles for document printing (also screen display) */
@media print {
  @layer latexcss-paged-print {
    :root {
      --body-color: black;
      --body-bg-color: white;
    }
    /* Overwrite always `latex-dark` colors with light ones */
    .latex-dark {
      /* LaTeX.css colors (`style.css`) */
      --body-color: black;
      --body-bg-color: white;
      --link-visited: hsl(0, 100%, 33%);
      --link-focus-outline: hsl(220, 90%, 52%);
      --pre-bg-color: hsl(210, 28%, 93%);
      --kbd-bg-color: hsl(210, 5%, 100%);
      --kbd-border-color: hsl(210, 5%, 70%);
      --table-border-color: black;
      --sidenote-target-border-color: hsl(55, 55%, 70%);
      --footnotes-border-color: hsl(0, 0%, 39%);
      --proof-symbol-filter: none;
      --body-background-color: hsl(0, 0%, 91%); /* just in case ... */
      --page-shadow-color: hsl(0, 0%, 81%); /* just in case ... */
      /* Prism.js colors (`/prism/prism.css`) */
      --bg-color: #F0F0F0;
      --color: black;
      --token-teal: #407f80;
      --token-black: #000000;
      --token-grey: #666666;
      --token-green: #007f00;
      --token-lime: #7d8f29;
      --token-brown: #9a6e3a;
      --token-red: #ba2121;
      --token-fuchsia: #dd4a68;
      --token-orange: #e90;
      --token-pink: #BA6687;
    }
  }

  /* Remember: the major web browsers still do not support CSS variables inside
   * the @page rule, at least for margins.
   */
  @page {
    size: A4 portrait;
    margin-top: 126.795pt;
    margin-right: 118.286pt;
    margin-bottom: 122.271pt;
    margin-left: 117.828pt;
    @bottom-center{
      content: counter(page);
      /* Adjust div.pagedjs_margin-bottom-center for page numbers */
      flex-direction: column;
      /* footskip = 29.888pt = 11pt + 18.888pt */  
      padding-top: 18.888pt;
    }
  }

  .pagedjs_page {
    color: var(--body-color);
    background-color: var(--body-bg-color);
  }

  body {
    /* ~ 11pt font-size */
    font-size: 0.913rem;
    /* One and half line spacing */
    line-height: 1.3;
    /* Reset LaTeX.css style properties */
    max-width: none;
    min-height: 0px;
    padding: 0px;
  }

  /* Fix sidenotes for A4 paper size */
  .sidenote {
    /* `marginparwidth` ~ 49.813pt[HTML] */
    width: 49.813pt;
    margin-right: -59.813pt;
  }
  /* Default LaTeX article has only margin notes on the right side margin */
  .sidenote.left {
    float: left;
    /* Same 10pt sep. from text because of simmetry */
    margin-left: -59.813pt;
  }


  /* It seems Paged.js still doesn't support `counters()` or there is some bug
   * when the ToC is split during pagination.
   * Here `counters()` is replaced with with a complex `counter()` construction,
   * with 3 levels of sectioning, like in LaTeX documents (excluding paragraphs):
   * `sec-level-1`, `sec-level-2`, `sec-level-3`.
   */

  /* ToC Level-1 */
  nav > ol {
    counter-reset: sec-level-1;
    /* No padding for ToC first-level sections in LaTeX default articles */
    padding-left: 0;
  }
  nav > ol > li {
    /* ToC first-level sections are in boldface type in LaTeX default articles */
    counter-increment: sec-level-1;
  }
  nav > ol > li::before {
    content: counter(sec-level-1);
    font-weight: bold;
  }
  nav > ol > li > a {
    font-weight: bold;
  }
  /* ToC Level-2 */
  nav > ol > li > ol {
    counter-reset: sec-level-2;
  }
  nav > ol > li > ol > li {
    counter-increment: sec-level-2;
  }
  nav > ol > li > ol > li::before {
    content: counter(sec-level-1) '.' counter(sec-level-2);
  }
  /* ToC Level-3 */
  nav > ol > li > ol > li > ol {
    counter-reset: sec-level-3;
  }
  nav > ol > li > ol > li > ol > li {
    counter-increment: sec-level-3;
  }
  nav > ol > li > ol > li > ol > li::before {
    content: counter(sec-level-1) '.' counter(sec-level-2) '.' counter(sec-level-3);
  }

  /* Add page numbers to the ToC.
   * `latexcss-paged.js` must be loaded if `toc-page-numbers` class is used.
   */
  .toc-page-numbers nav > ol li::before {
    float: left;
  }
  .toc-page-numbers nav li > a {
    display: flex;
    text-decoration-line: none;
  }
  /* Page numbers */
  .toc-page-numbers nav li > a::after {
    content: target-counter(attr(href), page);
    flex: 0 0 5%;
    align-self: flex-end;
    text-align: right;
    text-decoration-line: underline;
    padding-left: 0.85rem;
    background-color: var(--body-bg-color);
  }
  /* Add an extra gap between the ToC entry text and the page number container. */
  .toc-page-numbers nav div.toc-item-container {
    flex: 0 1 95%;
    padding-right: 1rem;
  }
  .toc-page-numbers nav > ol > li > ol span.dotted-line {
    background-color: var(--body-bg-color);
  }
  .toc-page-numbers nav > ol > li > ol span.dotted-line::after {
    content: ".............................................................................................................................";
    float: left;
    width: 0;
    letter-spacing: 5pt;
    color: var(--body-color);
  }
  /* Hide the fragment of dotted line outside the navigation container */
  .toc-page-numbers nav > ol > li > ol li {
    overflow: hidden;
  }
  .toc-page-numbers nav span.toc-item-content {
    background-color: var(--body-bg-color);
    text-decoration-line: underline;
  }
  /* Make an "inline gap" before dotted line. It has been used this solution
   * instead of [a more natural] `padding-right` to `.toc-item-content`
   * because of rendering differences between browsers. Also, tries to avoid
   * line breaks just before the dotted line.
   */
  .toc-page-numbers nav > ol > li > ol span.dotted-line::before {
    content: "\00a0"; /* non-breaking space */
    margin-left: 0.2em;
  }

}
/* Fortunately, there is no need to restore the light colors for
 * `prefers-color-scheme: dark`, because it seems the browser always "prefers"
 * the light scheme for printing by default (for the moment). See specification:
 * - https://www.w3.org/TR/mediaqueries-5/#prefers-color-scheme
 * - https://github.com/w3c/csswg-drafts/issues/3522#issuecomment-463300486
 * Otherwise (no default light scheme for printing), the following [required] code
 * will fail, because Paged.js limitations with `@media` queries.
 */

/* @media print and (prefers-color-scheme: dark) { */
/*   @layer latexcss-paged-print { */
/*     .latex-dark-auto { */
/*       /1* LaTeX.css colors (`style.css`) *1/ */
/*       --body-color: black; */
/*       --body-bg-color: white; */
/*       --link-visited: hsl(0, 100%, 33%); */
/*       --link-focus-outline: hsl(220, 90%, 52%); */
/*       --pre-bg-color: hsl(210, 28%, 93%); */
/*       --kbd-bg-color: hsl(210, 5%, 100%); */
/*       --kbd-border-color: hsl(210, 5%, 70%); */
/*       --table-border-color: black; */
/*       --sidenote-target-border-color: hsl(55, 55%, 70%); */
/*       --footnotes-border-color: hsl(0, 0%, 39%); */
/*       --proof-symbol-filter: none; */
/*       /1* Prism.js colors (`/prism/prism.css`) *1/ */
/*       --bg-color: #F0F0F0; */
/*       --color: black; */
/*       --token-teal: #407f80; */
/*       --token-black: #000000; */
/*       --token-grey: #666666; */
/*       --token-green: #007f00; */
/*       --token-lime: #7d8f29; */
/*       --token-brown: #9a6e3a; */
/*       --token-red: #ba2121; */
/*       --token-fuchsia: #dd4a68; */
/*       --token-orange: #e90; */
/*       --token-pink: #BA6687; */
/*     } */
/*   } */
/* } */

/* Styles for screen document display */
@media screen, pagedjs-ignore {
  @layer latexcss-paged-screen {
    :root {
      --body-color: hsl(0, 5%, 10%);
      --body-bg-color: hsl(210, 20%, 98%);
    }

    /* Restore original Dark Theme for screen display */
    .latex-dark {
      /* LaTeX.css colors (`style.css`) */
      --body-color: hsl(0, 0%, 86%);
      --body-bg-color: hsl(0, 0%, 16%);
      --link-visited: hsl(196 80% 77%);
      --link-focus-outline: hsl(215, 63%, 73%);
      --pre-bg-color: hsl(0, 1%, 25%);
      --kbd-bg-color: hsl(0, 0%, 16%);
      --kbd-border-color: hsl(210, 5%, 70%);
      --table-border-color: white;
      --sidenote-target-border-color: hsl(0, 0%, 59%);
      --footnotes-border-color: hsl(0, 0%, 59%);
      --proof-symbol-filter: invert(80%);
      --body-background-color: hsl(0, 0%, 23%);
      --page-shadow-color: black;
      /* Prism.js colors (`/prism/prism.css`) */
      --bg-color: #2d2d2d;
      --color: #ccc;
      --token-teal: #90D0D0;
      --token-black: #ccc;
      --token-grey: #999;
      --token-green: #51B53F;
      --token-lime: #B4C55D;
      --token-brown: #D3A26B;
      --token-red: #FA5E4F;
      --token-fuchsia: #FF839B;
      --token-orange: #FFCF4C;
      --token-pink: #F49BBC;
    }
  }

  body {
    background-color: var(--body-background-color);
  }

  .pagedjs_page {
    box-shadow: 0 0 3px 1px var(--page-shadow-color);
    margin-top: 35px;
    margin-left: auto;
    margin-right: auto;
  }

  .pagedjs_page:last-of-type {
    margin-bottom: 35px;
  }
}

@media screen and (prefers-color-scheme: dark), pagedjs-ignore {
  @layer latexcss-paged-screen {
    .latex-dark-auto {
      /* LaTeX.css colors (`style.css`) */
      --body-color: hsl(0, 0%, 86%);
      --body-bg-color: hsl(0, 0%, 16%);
      --link-visited: hsl(196 80% 77%);
      --link-focus-outline: hsl(215, 63%, 73%);
      --pre-bg-color: hsl(0, 1%, 25%);
      --kbd-bg-color: hsl(0, 0%, 16%);
      --kbd-border-color: hsl(210, 5%, 70%);
      --table-border-color: white;
      --sidenote-target-border-color: hsl(0, 0%, 59%);
      --footnotes-border-color: hsl(0, 0%, 59%);
      --proof-symbol-filter: invert(80%);
      --body-background-color: hsl(0, 0%, 23%);
      --page-shadow-color: black;
      /* Prism.js colors (`/prism/prism.css`) */
      --bg-color: #2d2d2d;
      --color: #ccc;
      --token-teal: #90D0D0;
      --token-black: #ccc;
      --token-grey: #999;
      --token-green: #51B53F;
      --token-lime: #B4C55D;
      --token-brown: #D3A26B;
      --token-red: #FA5E4F;
      --token-fuchsia: #FF839B;
      --token-orange: #FFCF4C;
      --token-pink: #F49BBC;
    }
  }
}
